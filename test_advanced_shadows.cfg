// Test Advanced Shadow Volumes (Mode 4)
// Execute with: /exec test_advanced_shadows

echo "^3========================================"
echo "^3Testing Advanced Shadow Volumes (Mode 4)"
echo "^3========================================"

// Disable RTX/RT (not working)
seta rtx_enable "0"
seta rt_enable "0"

// Enable advanced shadow volumes (mode 4)
echo "^2Enabling Advanced Shadow Volumes..."
seta r_shadows "4"
seta cg_shadows "3"  // Max value for cg_shadows

// Ensure stencil buffer is available
seta r_stencilbits "8"

// Dynamic lighting for shadows
seta r_dlightMode "2"
seta r_dynamiclight "1"
seta r_dlightIntensity "2.0"
seta r_dlightScale "1.5"

// Shadow maps for additional quality
seta r_shadowMapSize "4096"
seta r_shadowMapLod "4"

// Ensure proper lighting
seta r_vertexLight "0"
seta r_ambientScale "0.8"
seta r_directedScale "1.2"
seta r_lightmap "0"

// Debug output
seta r_showTris "0"
seta r_showNormals "0"
seta developer "1"

echo "^2Advanced shadow configuration loaded!"
echo "^3========================================"
echo "^3r_shadows is now: 4 (Advanced Volumes)"
echo "^3cg_shadows is: 3 (max client value)"
echo ""
echo "^7To verify shadows are working:"
echo "^7- Look for stencil shadow volumes"
echo "^7- Check console for shadow debug output"
echo "^7- Use /r_showTris 1 to see shadow geometry"
echo "^3========================================"

// Restart video to apply stencil buffer
vid_restart